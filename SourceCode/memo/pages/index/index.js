"use strict";
Page({
    data: {
        isNullData: true,
        memoListData: [],
        startX: 0,
        startY: 0
    },
    onPullDownRefresh: function () {
        console.log("监听用户下拉动作");
        this.getMemoListData();
    },
    onShow: function () {
        this.getMemoListData();
    },
    onLoad: function () {
        try {
            wx.setStorageSync('isEdit', false);
        }
        catch (e) { }
        this.getMemoListData();
    },
    getMemoListData: function () {
        try {
            var memoListData = wx.getStorageSync('memoListData');
            if (memoListData) {
                memoListData.forEach(function (item) {
                    item.isTouchMove = false;
                });
                this.setData({
                    memoListData: memoListData,
                    isNullData: false
                });
            }
            else {
                this.setData({
                    memoListData: [],
                    isNullData: true
                });
            }
        }
        catch (e) {
            wx.showToast({
                title: '获取备忘录数据失败，请稍后再试！',
                icon: 'none',
                duration: 1500
            });
        }
    },
    onClickNew: function () {
        console.log("点击新建");
        try {
            wx.setStorageSync('isEdit', false);
            wx.switchTab({
                url: '/pages/new/new'
            });
        }
        catch (e) { }
    },
    onClickEdit: function (event) {
        console.log("点击编辑");
        try {
            wx.setStorageSync('isEdit', true);
            var id = event.currentTarget.dataset.item.id;
            wx.setStorageSync('id', id);
            wx.switchTab({
                url: '/pages/new/new'
            });
        }
        catch (e) { }
    },
    onClickdeleteModal: function (event) {
        var that = this;
        wx.showModal({
            title: '删除提示',
            content: '是否确定删除该备忘录！',
            success: function (res) {
                if (res.confirm) {
                    that.onClickdelete(event);
                }
                else if (res.cancel) {
                }
            }
        });
    },
    onClickdelete: function (event) {
        try {
            var index = event.currentTarget.dataset.index;
            if (index != null && this.data.memoListData != null) {
                this.data.memoListData.splice(event.currentTarget.dataset.index, 1);
                this.setData({
                    memoListData: this.data.memoListData
                });
                wx.setStorageSync('memoListData', this.data.memoListData);
                if (this.data.memoListData.length == 0) {
                    wx.clearStorageSync();
                }
                wx.showToast({
                    title: '删除成功',
                    icon: 'success',
                    duration: 1000
                });
            }
        }
        catch (e) { }
    },
    touchstart: function (event) {
        console.log("touchstart");
        this.data.memoListData.forEach(function (item) {
            if (item.isTouchMove)
                item.isTouchMove = false;
        });
        this.setData({
            memoListData: this.data.memoListData,
            startX: event.changedTouches[0].clientX,
            startY: event.changedTouches[0].clientY
        });
    },
    touchmove: function (event) {
        console.log("touchmove");
        var that = this, index = event.currentTarget.dataset.index, startX = that.data.startX, startY = that.data.startY, touchMoveX = event.changedTouches[0].clientX, touchMoveY = event.changedTouches[0].clientY, angle = that.angle({ X: startX, Y: startY }, { X: touchMoveX, Y: touchMoveY });
        that.data.memoListData.forEach(function (v, i) {
            v.isTouchMove = false;
            if (Math.abs(angle) > 30)
                return;
            if (i == index) {
                if (touchMoveX > startX)
                    v.isTouchMove = false;
                else
                    v.isTouchMove = true;
            }
        });
        that.setData({
            memoListData: that.data.memoListData
        });
    },
    angle: function (start, end) {
        var _X = end.X - start.X, _Y = end.Y - start.Y;
        return 360 * Math.atan(_Y / _X) / (2 * Math.PI);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUEsSUFBSSxDQUFDO0lBQ0gsSUFBSSxFQUFFO1FBQ0osVUFBVSxFQUFFLElBQUk7UUFDaEIsWUFBWSxFQUFFLEVBQVc7UUFFekIsTUFBTSxFQUFFLENBQVc7UUFDbkIsTUFBTSxFQUFFLENBQVc7S0FDcEI7SUFLRCxpQkFBaUI7UUFDZixPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ3hCLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztJQUN6QixDQUFDO0lBS0QsTUFBTTtRQUNKLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztJQUN6QixDQUFDO0lBRUQsTUFBTTtRQUNKLElBQUk7WUFFRixFQUFFLENBQUMsY0FBYyxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQTtTQUNuQztRQUFDLE9BQU8sQ0FBQyxFQUFFLEdBQUc7UUFDZixJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7SUFDekIsQ0FBQztJQUtELGVBQWU7UUFFYixJQUFJO1lBQ0YsSUFBSSxZQUFZLEdBQUcsRUFBRSxDQUFDLGNBQWMsQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUNyRCxJQUFJLFlBQVksRUFBRTtnQkFFaEIsWUFBWSxDQUFDLE9BQU8sQ0FBQyxVQUFDLElBQVM7b0JBRTdCLElBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO2dCQUMzQixDQUFDLENBQUMsQ0FBQztnQkFDSCxJQUFJLENBQUMsT0FBUSxDQUFDO29CQUNaLFlBQVksRUFBRSxZQUFZO29CQUMxQixVQUFVLEVBQUUsS0FBSztpQkFDbEIsQ0FBQyxDQUFBO2FBQ0g7aUJBQU07Z0JBQ0wsSUFBSSxDQUFDLE9BQVEsQ0FBQztvQkFDWixZQUFZLEVBQUUsRUFBUztvQkFDdkIsVUFBVSxFQUFFLElBQUk7aUJBQ2pCLENBQUMsQ0FBQTthQUNIO1NBQ0Y7UUFBQyxPQUFPLENBQUMs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QUNqQyxJQUFJLENBQUMsSUFBSSxLQUFLLEVBQUU7Z0JBQ2QsSUFBSSxVQUFVLEdBQUcsTUFBTTtvQkFDckIsQ0FBQyxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUE7O29CQUVyQixDQUFDLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQTthQUN2QjtRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLE9BQVEsQ0FBQztZQUNaLFlBQVksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVk7U0FDckMsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUtELEtBQUssWUFBQyxLQUFVLEVBQUUsR0FBUTtRQUN4QixJQUFJLEVBQUUsR0FBRyxHQUFHLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLEdBQUcsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQTtRQUU5QyxPQUFPLEdBQUcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDbEQsQ0FBQztDQUVGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8vaW5kZXguanNcblxuUGFnZSh7XG4gIGRhdGE6IHtcbiAgICBpc051bGxEYXRhOiB0cnVlLFxuICAgIG1lbW9MaXN0RGF0YTogW10gYXMgYW55W10sXG4gICAgLy/lvIDlp4vlnZDmoIdcbiAgICBzdGFydFg6IDAgYXMgbnVtYmVyLFxuICAgIHN0YXJ0WTogMCBhcyBudW1iZXJcbiAgfSxcblxuICAvKipcbiAgICog6aG16Z2i55u45YWz5LqL5Lu25aSE55CG5Ye95pWwLS3nm5HlkKznlKjmiLfkuIvmi4nliqjkvZxcbiAgICovXG4gIG9uUHVsbERvd25SZWZyZXNoKCkge1xuICAgIGNvbnNvbGUubG9nKFwi55uR5ZCs55So5oi35LiL5ouJ5Yqo5L2cXCIpO1xuICAgIHRoaXMuZ2V0TWVtb0xpc3REYXRhKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5pi+56S6XG4gICAqL1xuICBvblNob3coKSB7XG4gICAgdGhpcy5nZXRNZW1vTGlzdERhdGEoKTtcbiAgfSxcblxuICBvbkxvYWQoKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOiuvue9rue8lui+keeKtuaAgVxuICAgICAgd3guc2V0U3RvcmFnZVN5bmMoJ2lzRWRpdCcsIGZhbHNlKVxuICAgIH0gY2F0Y2ggKGUpIHsgfVxuICAgIHRoaXMuZ2V0TWVtb0xpc3REYXRhKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIOiOt+WPluWkh+W/mOW9leaVsOaNrua6kFxuICAgKi9cbiAgZ2V0TWVtb0xpc3REYXRhKCkge1xuICAgIC8vIOiOt+WPluacrOWcsOe8k+WtmOWkh+W/mOW9leWIl+ihqOaVsOaNrlxuICAgIHRyeSB7XG4gICAgICBsZXQgbWVtb0xpc3REYXRhID0gd3guZ2V0U3RvcmFnZVN5bmMoJ21lbW9MaXN0RGF0YScpO1xuICAgICAgaWYgKG1lbW9MaXN0RGF0YSkge1xuXG4gICAgICAgIG1lbW9MaXN0RGF0YS5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcbiAgICAgICAgICAvL+m7mOiupOmakOiXj+WIoOmZpFxuICAgICAgICAgIGl0ZW0uaXNUb3VjaE1vdmUgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICAgIG1lbW9MaXN0RGF0YTogbWVtb0xpc3REYXRhLFxuICAgICAgICAgIGlzTnVsbERhdGE6IGZhbHNlXG4gICAgICAgIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICAgICBtZW1vTGlzdERhdGE6IFtdIGFzIGFueSxcbiAgICAgICAgICBpc051bGxEYXRhOiB0cnVlXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgd3guc2hvd1RvYXN0KHtcbiAgICAgICAgdGl0bGU6ICfojrflj5blpIflv5jlvZXmlbDmja7lpLHotKXvvIzor7fnqI3lkI7lho3or5XvvIEnLFxuICAgICAgICBpY29uOiAnbm9uZScsXG4gICAgICAgIGR1cmF0aW9uOiAxNTAwXG4gICAgICB9KVxuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICog54K55Ye75paw5bu6XG4gICAqL1xuICBvbkNsaWNrTmV3KCkge1xuICAgIGNvbnNvbGUubG9nKFwi54K55Ye75paw5bu6XCIpO1xuICAgIHRyeSB7XG4gICAgICAvLyDorr7nva7nvJbovpHnirbmgIFcbiAgICAgIHd4LnNldFN0b3JhZ2VTeW5jKCdpc0VkaXQnLCBmYWxzZSlcbiAgICAgIC8vIOWIh+aNouWIsOaWsOW7ulxuICAgICAgd3guc3dpdGNoVGFiKHtcbiAgICAgICAgdXJsOiAnL3BhZ2VzL25ldy9uZXcnXG4gICAgICB9KVxuICAgIH0gY2F0Y2ggKGUpIHsgfVxuICB9LFxuXG4gIC8qKlxuICAgKiDngrnlh7vnvJbovpFcbiAgICovXG4gIG9uQ2xpY2tFZGl0KGV2ZW50OiBhbnkpIHtcbiAgICBjb25zb2xlLmxvZyhcIueCueWHu+e8lui+kVwiKTtcbiAgICB0cnkge1xuICAgICAgLy8g6K6+572u57yW6L6R54q25oCBXG4gICAgICB3eC5zZXRTdG9yYWdlU3luYygnaXNFZGl0JywgdHJ1ZSlcbiAgICAgIGxldCBpZCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pdGVtLmlkO1xuICAgICAgLy8g6K6+572u57yW6L6R54q25oCBXG4gICAgICB3eC5zZXRTdG9yYWdlU3luYygnaWQnLCBpZClcbiAgICAgIC8vIOWIh+aNouWIsOaWsOW7ulxuICAgICAgd3guc3dpdGNoVGFiKHtcbiAgICAgICAgdXJsOiAnL3BhZ2VzL25ldy9uZXcnXG4gICAgICB9KVxuICAgIH0gY2F0Y2ggKGUpIHsgfVxuICB9LFxuXG4gIC8qKlxuICAgKiDliKDpmaTmj5DnpLpcbiAgICovXG4gIG9uQ2xpY2tkZWxldGVNb2RhbChldmVudDogYW55KSB7XG4gICAgbGV0IHRoYXQgPSB0aGlzO1xuICAgIHd4LnNob3dNb2RhbCh7XG4gICAgICB0aXRsZTogJ+WIoOmZpOaPkOekuicsXG4gICAgICBjb250ZW50OiAn5piv5ZCm56Gu5a6a5Yig6Zmk6K+l5aSH5b+Y5b2V77yBJyxcbiAgICAgIHN1Y2Nlc3MocmVzKSB7XG4gICAgICAgIGlmIChyZXMuY29uZmlybSkge1xuICAgICAgICAgIHRoYXQub25DbGlja2RlbGV0ZShldmVudCk7XG4gICAgICAgIH0gZWxzZSBpZiAocmVzLmNhbmNlbCkge1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgfSxcblxuICAvKipcbiAgICog54K55Ye75Yig6ZmkXG4gICAqL1xuICBvbkNsaWNrZGVsZXRlKGV2ZW50OiBhbnkpIHtcbiAgICB0cnkge1xuICAgICAgbGV0IGluZGV4OiBudW1iZXIgPSBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaW5kZXg7XG4gICAgICBpZiAoaW5kZXggIT0gbnVsbCAmJiB0aGlzLmRhdGEubWVtb0xpc3REYXRhICE9IG51bGwpIHtcbiAgICAgICAgdGhpcy5kYXRhLm1lbW9MaXN0RGF0YS5zcGxpY2UoZXZlbnQuY3VycmVudFRhcmdldC5kYXRhc2V0LmluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgICAgbWVtb0xpc3REYXRhOiB0aGlzLmRhdGEubWVtb0xpc3REYXRhXG4gICAgICAgIH0pXG4gICAgICAgIC8v5byC5q2l5pu05paw5YiX6KGo57yT5a2YXG4gICAgICAgIHd4LnNldFN0b3JhZ2VTeW5jKCdtZW1vTGlzdERhdGEnLCB0aGlzLmRhdGEubWVtb0xpc3REYXRhKTtcbiAgICAgICAgaWYgKHRoaXMuZGF0YS5tZW1vTGlzdERhdGEubGVuZ3RoID09IDApIHtcbiAgICAgICAgICB3eC5jbGVhclN0b3JhZ2VTeW5jKCk7XG4gICAgICAgIH1cbiAgICAgICAgd3guc2hvd1RvYXN0KHtcbiAgICAgICAgICB0aXRsZTogJ+WIoOmZpOaIkOWKnycsXG4gICAgICAgICAgaWNvbjogJ3N1Y2Nlc3MnLFxuICAgICAgICAgIGR1cmF0aW9uOiAxMDAwXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHsgfVxuICB9LFxuXG4gIC8qKlxuICAgKiDmiYvmjIfop6bmkbjliqjkvZzlvIDlp4sg6K6w5b2V6LW354K5WOWdkOagh1xuICAgKi9cbiAgdG91Y2hzdGFydChldmVudDogYW55KSB7XG4gICAgY29uc29sZS5sb2coXCJ0b3VjaHN0YXJ0XCIpO1xuICAgIC8v5byA5aeL6Kem5pG45pe2IOmHjee9ruaJgOacieWIoOmZpFxuICAgIHRoaXMuZGF0YS5tZW1vTGlzdERhdGEuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7XG4gICAgICAvL+WPquaTjeS9nOS4unRydWXnmoRcbiAgICAgIGlmIChpdGVtLmlzVG91Y2hNb3ZlKVxuICAgICAgICBpdGVtLmlzVG91Y2hNb3ZlID0gZmFsc2U7XG4gICAgfSk7XG4gICAgLy/mm7TmlrDmlbDmja5cbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIG1lbW9MaXN0RGF0YTogdGhpcy5kYXRhLm1lbW9MaXN0RGF0YSxcbiAgICAgIHN0YXJ0WDogZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WCxcbiAgICAgIHN0YXJ0WTogZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WVxuICAgIH0pXG4gIH0sXG5cbiAgLyoqXG4gICAqIOa7keWKqOS6i+S7tuWkhOeQhlxuICAgKi9cbiAgdG91Y2htb3ZlKGV2ZW50OiBhbnkpIHtcbiAgICBjb25zb2xlLmxvZyhcInRvdWNobW92ZVwiKTtcbiAgICBsZXQgdGhhdCA9IHRoaXMsXG4gICAgICBpbmRleCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pbmRleCwvL+W9k+WJjee0ouW8lVxuICAgICAgc3RhcnRYID0gdGhhdC5kYXRhLnN0YXJ0WCwvL+W8gOWni1jlnZDmoIdcbiAgICAgIHN0YXJ0WSA9IHRoYXQuZGF0YS5zdGFydFksLy/lvIDlp4tZ5Z2Q5qCHXG4gICAgICB0b3VjaE1vdmVYID0gZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WCwvL+a7keWKqOWPmOWMluWdkOagh1xuICAgICAgdG91Y2hNb3ZlWSA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFksLy/mu5Hliqjlj5jljJblnZDmoIdcbiAgICAgIC8v6I635Y+W5ruR5Yqo6KeS5bqmXG4gICAgICBhbmdsZSA9IHRoYXQuYW5nbGUoeyBYOiBzdGFydFgsIFk6IHN0YXJ0WSB9LCB7IFg6IHRvdWNoTW92ZVgsIFk6IHRvdWNoTW92ZVkgfSk7XG5cbiAgICB0aGF0LmRhdGEubWVtb0xpc3REYXRhLmZvckVhY2goKHY6IGFueSwgaTogbnVtYmVyKSA9PiB7XG4gICAgICB2LmlzVG91Y2hNb3ZlID0gZmFsc2VcbiAgICAgIC8v5ruR5Yqo6LaF6L+HMzDluqbop5IgcmV0dXJuXG4gICAgICBpZiAoTWF0aC5hYnMoYW5nbGUpID4gMzApIHJldHVybjtcbiAgICAgIGlmIChpID09IGluZGV4KSB7XG4gICAgICAgIGlmICh0b3VjaE1vdmVYID4gc3RhcnRYKSAvL+WPs+a7kVxuICAgICAgICAgIHYuaXNUb3VjaE1vdmUgPSBmYWxzZVxuICAgICAgICBlbHNlIC8v5bem5ruRXG4gICAgICAgICAgdi5pc1RvdWNoTW92ZSA9IHRydWVcbiAgICAgIH1cbiAgICB9KTtcbiAgICAvL+abtOaWsOaVsOaNrlxuICAgIHRoYXQuc2V0RGF0YSEoe1xuICAgICAgbWVtb0xpc3REYXRhOiB0aGF0LmRhdGEubWVtb0xpc3REYXRhXG4gICAgfSlcbiAgfSxcblxuICAvKipcbiAgICog6K6h566X5ruR5Yqo6KeS5bqmXG4gICAqL1xuICBhbmdsZShzdGFydDogYW55LCBlbmQ6IGFueSkge1xuICAgIGxldCBfWCA9IGVuZC5YIC0gc3RhcnQuWCwgX1kgPSBlbmQuWSAtIHN0YXJ0LllcbiAgICAvL+i/lOWbnuinkuW6piBNYXRoLmF0YW4oKei/lOWbnuaVsOWtl+eahOWPjeato+WIh+WAvFxuICAgIHJldHVybiAzNjAgKiBNYXRoLmF0YW4oX1kgLyBfWCkgLyAoMiAqIE1hdGguUEkpO1xuICB9XG5cbn0pXG4iXX0=